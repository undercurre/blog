---
title: 小程序模板
date: 2023-01-05 19:57:24
tags:
---

# 小程序模板构建

## 使用 npm

替换 project.config.json

```json
// 在setting中添加
    "packNpmManually": true,

    "packNpmRelationList": [

      {
        "packageJsonPath": "./package.json",

        "miniprogramNpmDistDir": "miniprogram/"
      }
    ],
```

在开发者工具右侧**详情**中勾选**使用 npm 模块**
最后在开发者工具**工具栏**选取**构建 npm**

## 组件库使用 vant-weapp

```
pnpm i @vant/weapp -S --production
```

```wxss
// 在app.wxss中添加
@import "./miniprogram_npm//@vant/weapp/common/index.wxss";
```

**使用的时候要在 json 中添加配置（todo: 暂时没有 unplugin 插件，之后自己搞一个试一下）**

```
"usingComponents": {
  "van-button": "/miniprogram_npm/@vant/weapp/button/index"
}
```

## .gitignore

新建.gitignore 文件

```
miniprogram/miniprogram_npm/*
node_modules/*
```

## miniprogram-computed

提供给你向 vue 一样的 computed 计算属性和 watch 监听器

**这个包有两个依赖**

```
pnpm install --save miniprogram-computed
pnpm install rfdc --save
pnpm install fast-deep-equal
```

```ts
import { ComponentWithComputed } from "miniprogram-computed";

ComponentWithComputed({
  data: {
    a: 1,
    b: 1,
    c: 1,
    sum: 2,
  },
  watch: {
    "a, b": function (a, b) {
      this.setData({
        c: a + b,
      });
    },
  },
  computed: {
    sum(data) {
      // 注意： computed 函数中不能访问 this ，只有 data 对象可供访问
      // 这个函数的返回值会被设置到 this.data.sum 字段中
      return data.a + data.b + data.c; // data.c 为自定义 behavior 数据段
    },
  },
  methods: {
    onTapa() {
      this.setData({
        a: this.data.a + 1,
      });
    },
    onTapb() {
      this.setData({
        b: this.data.b + 2,
      });
    },
  },
});
```
